<table mat-table class="components-table" [dataSource]="datasource"
       [multiTemplateDataRows]="!!expandedTemplate">
  <ng-container *ngFor="let displayedColumn of displayedColumns" [matColumnDef]="displayedColumn.title">
    <th mat-header-cell *matHeaderCellDef>{{ displayedColumn.title }}</th>
    <td mat-cell *matCellDef="let component">
      <p class="text-truncate">{{ displayedColumn.value(component) }}</p>
    </td>
  </ng-container>

  <!-- Buttons Column -->
  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef>Actions</th>
    <td mat-cell *matCellDef="let component">
      <div fxFlex="row" fxLayoutAlign="end center">
        <button mat-icon-button [matMenuTriggerFor]="moreMenu" aria-label="More"
                (click)="$event.stopPropagation();">
          <mat-icon class="secondary-text">more_vert</mat-icon>
        </button>
        <mat-menu #moreMenu="matMenu">
          <ng-container [ngTemplateOutlet]="actionsTemplate"
                        [ngTemplateOutletContext]="{$implicit:component}">
          </ng-container>
        </mat-menu>
      </div>

    </td>
  </ng-container>


  <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
  <ng-container matColumnDef="expandedDetail">

    <td mat-cell *matCellDef="let element" [attr.colspan]="columns.length">
      <div class="example-element-detail"
           [@detailExpand]="element === expandedElement ? 'expanded' : 'collapsed'">
        <ng-container *ngIf="element === expandedElement" [ngTemplateOutlet]="expandedTemplate"
                      [ngTemplateOutletContext]="{$implicit:element}">
        </ng-container>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="columns"></tr>

  <tr mat-row *matRowDef="let component; columns: columns;" [style.cursor]="cursor"
      class="example-element-row"
      [class.example-expanded-row]="expandedElement === component" (click)="lineClick(component)">
  </tr>

  <ng-container *ngIf="!!expandedTemplate">
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row"></tr>
  </ng-container>

</table>

<mat-paginator *ngIf="displayPagination"
               [pageSizeOptions]="pageSizeOptions"
               [length]='totalElements ?? pagination.totalElements ?? datasource.data.length'
               [pageIndex]="pageIndex ?? pagination.page ?? 0"
               [pageSize]="pageSize ?? pagination.size ?? pageSizeOptions[0]"
               (page)="pageEvent($event)">
</mat-paginator>
